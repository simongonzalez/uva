
#This setup allows the reading of large files
options(shiny.maxRequestSize = 100*1024^2)

#Server setup for the app
shinyServer(function(input, output, session) {
  
  autoInvalidate <- reactiveTimer(2000)
  
  #======================================================================================
  #======================================================================================
  # DOCUMENTATION------------------------------------------------------------------------
  # FUNCTIONS----------------------------------------------------------------------------
  # INPUT FILES--------------------------------------------------------------------------
  # PLOTTING UNITS-----------------------------------------------------------------------
  # DATA SUMMARY-------------------------------------------------------------------------
  #======================================================================================
  #======================================================================================
  
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #This section shows all the documentation of the program
  source(file.path("server/overallsetup", "server_documentation.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #Functions
  source(file.path("server/overallsetup", "server_functions.R"), 
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #This section inputs the file uploaded to the app environment
  source(file.path("server/overallsetup", "server_importfiles.R"), 
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #Plotting units
  source(file.path("server/overallsetup", "server_plottingunits.R"), 
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #Creates the reactive object - DT table with output
  source(file.path("server/overallsetup", "server_datasummary.R"), 
         local = TRUE)$values
  
  #======================================================================================
  #======================================================================================
  # DATA INSPECTION----------------------------------------------------------------------
  #======================================================================================
  #======================================================================================

  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/datainspection", "server_datainspection_controls.R"), 
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/datainspection", "server_datainspection_data.R"), 
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/datainspection", "server_datainspection_plot.R"), 
         local = TRUE)$values
  #:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
  source(file.path("server/datainspection", "server_datainspection_graphics.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/datainspection", "server_datainspection_click.R"),
         local = TRUE)$values

  #======================================================================================
  #======================================================================================
  # LANDMARKS----------------------------------------------------------------------------
  #======================================================================================
  #======================================================================================

  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/landmarks", "server_landmarks_controls.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/landmarks", "server_landmarks_data.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/landmarks", "server_landmarks_plot.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/landmarks", "server_landmarks_click.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #This section controls the definition and classification of landmarks..................
  source(file.path("server/landmarks", "server_landmarks_definitions.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #This section prepares and displays the landmark table.................................
  source(file.path("server/landmarks", "server_landmarks_table.R"),
         local = TRUE)$values
  
  #======================================================================================
  #======================================================================================
  # GRIDLINES----------------------------------------------------------------------------
  #======================================================================================
  #======================================================================================

  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #This section controls the visualisation of the xy information of the point clicked....
  source(file.path("server/gridlines", "server_gridlines_click.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/gridlines", "server_gridlines_controls.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/gridlines", "server_gridlines_plot.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/gridlines", "server_gridlines_buttons.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  #Controls the behaviour of the manual fieldview button.................................
  source(file.path("server/gridlines", "server_gridlines_fieldview.R"),
         local = TRUE)$values

  #======================================================================================
  #======================================================================================
  # INTERSECTIONS DATA-------------------------------------------------------------------
  #======================================================================================
  #======================================================================================
  
  source(file.path("server/intersectionsdata", "server_intersectionsdata_data.R"),
         local = TRUE)$values
  
  #======================================================================================
  #======================================================================================
  # MAIN ANALYSIS------------------------------------------------------------------------
  #======================================================================================
  #======================================================================================
  
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/mainanalysis", "server_mainanalysis_controls.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::  
  source(file.path("server/mainanalysis", "server_mainanalysis_plot.R"),
         local = TRUE)$values
  #:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
  source(file.path("server/mainanalysis", "server_mainanalysis_displacements.R"),
         local = TRUE)$values
  
  #======================================================================================
  #======================================================================================
  # SSANOVAS-----------------------------------------------------------------------------
  #======================================================================================
  #======================================================================================
  
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/ssanovas", "server_ssanovas_controls.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/ssanovas", "server_ssanovas_data.R"),
         local = TRUE)$values
  #::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  source(file.path("server/ssanovas", "server_ssanovas_plots.R"),
         local = TRUE)$values
})




